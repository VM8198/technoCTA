<?phpclass BookingsController extends AppController{    var $uses = array('Booking','Course','User','TransactionLog') ;    var $components = array('Auth','Session','Email','RequestHandler');	var $helpers = array('Html','Form','Csv');        function beforeFilter() {        parent::beforeFilter();		$this->Auth->allow('admin_deleteBooking','admin_export');    }//   function admin_bookingList($id = NULL) {//         $this->layout = "admin";// 		//$order = array('Booking.id'=>'DESC');		// 		$this->paginate = array(// 			'Limit'=>10// 		);// 		$bookinglist = $this->paginate('Booking');// 		//pr($bookinglist); die();// 		$this->set(compact('bookinglist'));//     }    function admin_bookingList($id = NULL) {        $this->layout = "admin";		//pr($this->request->data); die;		$payStatus = $this->TransactionLog->find('all', array('fields' => array('DISTINCT TransactionLog.status'),'conditions'=>array('TransactionLog.status !='=>'AuthCode: 376297')));		$getValue = array();        $getvalue = $_GET;		$filterval = array_filter($_GET);		$result = array();		foreach ($filterval as $key => $val) {            if ($key == "status") {                if($val=="Declined"){					$result['TransactionLog.status'] = "Declined";				}else{					 $result['TransactionLog.status'] = $val;				}            }else{				$result[$key] = $val;			}		}		if (!empty($filterval)) {            $conditions = $result;        } else {			$conditions = array('TransactionLog.status !=' =>'AuthCode: 376297');        }		//pr($result); die;		$this->paginate = array(			'conditions' => $conditions,			'limit' => 10		);		$bookinglist =  $this->paginate('TransactionLog');        $this->set(compact('bookinglist','payStatus','getvalue'));    }    function admin_viewBooking($id = NULL) {        $this->layout = "admin";        $BookingDetail = $this->TransactionLog->find('first', array('conditions' => array('TransactionLog.id' => $id)));        //pr($BookingDetail); die();        $this->set(compact('BookingDetail'));    }		 function admin_deleteBooking($id = NULL) {		$this->autoRender = FALSE;		if ($this->TransactionLog->delete($id)) {			$this->Session->setFlash('You have successfully deleted bookings detail');			$this->redirect(array('controller' => 'bookings', 'action' => 'admin_bookingList'));		}	}		function admin_export()	{		$this->response->download("Bookingdetail.csv");		$data = $this->TransactionLog->find('all',array('fields'=>array("TransactionLog.id","TransactionLog.user_id","TransactionLog.course_id","TransactionLog.order_id","TransactionLog.amount_major","TransactionLog.status","TransactionLog.transaction_datetime_txt","TransactionLog.gateway_message","TransactionLog.integration_type")));		//pr($data); die;		$this->set(compact('data'));		$this->layout = 'ajax';		return;			}	 // function admin_searchBooking(){	// 	$this->autoRender = FALSE;	// 	//$order = $this->request->data['Booking']['order_id']= $this->request->data['Booking']['order_id'];	// 	pr($this->request->data); die;	// } 	}